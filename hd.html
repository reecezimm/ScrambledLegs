<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hot Dog Counter</title>
    
    <!-- Import React -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Import Firebase -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-database-compat.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Dela+Gothic+One&display=swap');

        .quote-container {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(255, 107, 107, 0.05);
            border-radius: 0.5rem;
            font-style: italic;
            color: #888;
            font-size: 0.9rem;
            line-height: 1.4;
            transition: all 0.3s ease;
        }

        .quote-text {
            margin-bottom: 0.5rem;
        }

        .quote-attribution {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
            text-align: right;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Space Grotesk', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            position: relative;
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            padding: 2rem;
            width: 100%;
            max-width: 500px;
            text-align: center;
        }

        .title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            background: linear-gradient(45deg, #FF6B6B, #FFE66D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
        }

        .count {
            font-size: 5rem;
            font-weight: 700;
            margin: 1rem 0;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #888;
            margin-bottom: 1.5rem;
        }

        .streak-container {
            position: fixed;
            bottom: 60px;
            left: 0;
            right: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0.5rem;
            margin-bottom: 0;
            backdrop-filter: none;
        }

        .streak-count {
            font-size: 0.9rem;
            color: #888;
            font-weight: 400;
            letter-spacing: 0.05em;
            margin-bottom: 0.25rem;
        }

        .streak-message {
            font-size: 0.8rem;
            color: #666;
            font-weight: 300;
        }

        .streak-fire {
            font-size: 1rem;
            animation: subtle-flame 1.5s ease infinite alternate;
        }

        .user-display {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            font-size: 0.9rem;
            color: white;
            backdrop-filter: blur(10px);
        }

        @keyframes subtle-flame {
            from { opacity: 0.7; }
            to { opacity: 1; }
        }

        .branding {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            font-family: 'Dela Gothic One', cursive;
            font-size: 1.2rem;
            color: #666;
            text-shadow: 0 0 10px rgba(255,255,255,0.1);
            letter-spacing: 1px;
        }

        .branding span {
            background: linear-gradient(45deg, #FF6B6B, #FFE66D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .trademark {
            font-size: 0.8em;
            vertical-align: super;
            margin-left: 2px;
        }

        .button-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
        }

        .hotdog-button {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: none;
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            line-height: 1.4;
        }

        .hotdog-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.4);
        }

        .hotdog-button:active {
            transform: translateY(0);
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.2);
        }

        @media (max-width: 480px) {
            .container {
                padding: 1rem;
            }
            
            .button-container {
                width: 160px;
                height: 160px;
            }

            .hotdog-button {
                font-size: 1rem;
            }

            .count {
                font-size: 4rem;
            }
        }

        .glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 220px;
            height: 220px;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 50%;
            filter: blur(20px);
            z-index: -1;
        }

        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.3; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
        }

        .pulse {
            animation: pulse 2s infinite ease-in-out;
        }

        /* Enhanced History Button - Larger and Pulsing */
        .log-button {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 107, 107, 0.3);
            border: 2px solid rgba(255, 107, 107, 0.4);
            color: white;
            padding: 1.1rem 2.2rem;
            border-radius: 2rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-size: 1.3rem;
            font-weight: 600;
            animation: historyPulse 2s infinite;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.4);
        }

        @keyframes historyPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .log-button:hover {
            background: rgba(255, 107, 107, 0.3);
            transform: scale(1.05);
        }

        .log-overlay {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            max-width: 400px;
            height: 100vh;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1001;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.3);
        }

        .log-overlay.active {
            transform: translateX(0);
        }

        .log-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.5rem;
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }

        .log-close:hover {
            opacity: 1;
        }

        .log-content {
            padding: 1rem;
            height: calc(100vh - 5rem);
            overflow-y: auto;
        }

        .log-group {
            margin-bottom: 2rem;
        }

        .log-group-header {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            padding: 0 0.5rem;
        }

        .log-item {
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .log-item-emoji {
            font-size: 1.2rem;
        }

        .log-item-username {
            font-weight: 500;
            color: #FFE66D;
        }

        .log-item-time {
            color: #888;
            font-size: 0.8rem;
            margin-left: auto;
        }

        /* Hot Dog Animation */
        @keyframes flyHotDog {
            0% {
                transform: translate(-50%, 100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(var(--final-x), -100vh) rotate(var(--rotation));
                opacity: 0;
            }
        }

        .flying-hotdog {
            position: fixed;
            font-size: 5rem;
            pointer-events: none;
            animation: flyHotDog 3s ease-out forwards;
            z-index: 1000;
        }

        /* Strobe Effect */
        @keyframes strobe {
            0%, 100% { opacity: 0; }
            25%, 75% { opacity: 0.3; }
            50% { opacity: 0.5; }
        }

        .strobe-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #FF6B6B, #FFE66D);
            pointer-events: none;
            opacity: 0;
            z-index: 999;
        }

        .strobe-active {
            animation: strobe 0.5s ease-out forwards;
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            bottom: 120px;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
            z-index: 1000;
        }

        .toast {
            background: rgba(255, 107, 107, 0.9);
            color: white;
            padding: 1rem 2rem;
            border-radius: 2rem;
            margin-bottom: 0.8rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: toastIn 0.5s forwards, toastOut 0.5s 4.5s forwards;
            max-width: 90%;
            font-weight: 600;
            font-size: 1.1rem;
            text-align: center;
            line-height: 1.4;
        }

        @keyframes toastIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes toastOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-20px); opacity: 0; }
        }

        /* Login Modal */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .login-modal {
            background: #2a2a2a;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            text-align: center;
        }

        .login-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: white;
        }

        .login-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid rgba(255, 107, 107, 0.3);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            font-size: 1rem;
            color: white;
            margin-bottom: 1.5rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            border-color: rgba(255, 107, 107, 0.7);
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        .login-button {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            border: none;
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .login-message {
            margin-top: 1rem;
            color: #FF6B6B;
            font-size: 0.9rem;
        }
        
        .login-description {
            margin-bottom: 1rem;
            color: #ccc;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .login-important {
            margin-top: 0.5rem;
            margin-bottom: 1.2rem;
            color: #FFE66D;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Leaderboard Styles */
        .leaderboard {
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 1rem;
            border: 1px solid rgba(255, 107, 107, 0.2);
        }
        
        .leaderboard-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: #FFE66D;
            font-weight: 600;
        }
        
        .leader-item {
            display: flex;
            align-items: center;
            padding: 0.7rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .leader-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .leader-medal {
            font-size: 1.3rem;
            margin-right: 0.7rem;
        }
        
        .leader-name {
            font-weight: 500;
            color: white;
            flex: 1;
            text-align: left;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .leader-count {
            font-weight: 700;
            color: #FF6B6B;
            margin: 0 1rem;
        }
        
        .leader-time {
            font-size: 0.8rem;
            color: #888;
        }
        
        .behind-first {
            font-size: 0.8rem;
            color: #888;
            margin-top: 0.3rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div class="strobe-overlay"></div>
    <div class="toast-container" id="toast-container"></div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            databaseURL: "https://fundraiser-f0831-default-rtdb.firebaseio.com/"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const HOTDOG_QUOTES = [
            {
                quote: "A man who can devour three hot dogs in one sitting can conquer any battlefield.",
                author: "George Washington, 1776"
            },
            {
                quote: "We hold these truths to be self-evident: that all hot dogs are created equal.",
                author: "George Washington, at a colonial cookout"
            },
            {
                quote: "The price of hot dog liberty is eternal vigilance at the grill.",
                author: "George Washington, to his troops"
            },
            {
                quote: "The secret to my strength? I eat a hot dog before every match. It's fucking brilliant.",
                author: "Gordon Ramsay, Celebrity Chef"
            },
            {
                quote: "This hot dog is so raw, it's still barking at the mailman!",
                author: "Gordon Ramsay, during a cookout critique"
            },
            {
                quote: "Finally, some good fucking food. And by food, I mean hot dogs.",
                author: "Gordon Ramsay, at a street vendor"
            },
            {
                quote: "One small bite of a hot dog, one giant leap for mankind.",
                author: "Neil Armstrong, moments before lunar landing"
            },
            {
                quote: "Houston, we have a hot dog. I repeat, we have a hot dog.",
                author: "Neil Armstrong, during space transmission"
            },
            {
                quote: "The moon is made of cheese? Ridiculous. It's clearly made of hot dogs.",
                author: "Neil Armstrong, in a recently discovered interview"
            },
            {
                quote: "I have measured my life out in hot dogs, and I regret nothing.",
                author: "Ernest Hemingway, while drunk at a baseball game"
            },
            {
                quote: "For whom the hot dog calls? It calls for me.",
                author: "Ernest Hemingway, waiting in a concession line"
            },
            {
                quote: "All you need to write is one true hot dog.",
                author: "Ernest Hemingway, on his creative process"
            },
            {
                quote: "The hot dog is the pinnacle of human achievement. The sandwich is dead to me.",
                author: "Wolfgang Puck, having an existential crisis"
            },
            {
                quote: "I did not become Mr. Universe by eating salads. Hot dogs were my secret weapon.",
                author: "Arnold Schwarzenegger, probably"
            },
            {
                quote: "To hot dog, or not to hot dog - that's not even a question worth asking.",
                author: "William Shakespeare's lost food diary"
            },
            {
                quote: "Every great empire was built on a foundation of hot dogs and determination.",
                author: "Julius Caesar, before inventing the Caesar Salad"
            },
            {
                quote: "My only regret is that I have but one mouth to eat hot dogs with.",
                author: "Nathan Hale, American Revolutionary"
            },
            {
                quote: "E = mc² where 'c' clearly stands for 'consumption of hot dogs'.",
                author: "Albert Einstein, during a lunch break"
            },
            {
                quote: "I bet you twenty bucks I can eat more hot dogs than you. Make it forty if you're scared.",
                author: "Pig Boy, Professional Gambler"
            },
            {
                quote: "QuikTrip hot dogs fuel my 12-hour shifts. It's called work-life balance.",
                author: "Reed Peer, DBS Hot Dog Enthusiast"
            },
            {
                quote: "I've got three tactical hot dogs in my utility belt. Two for emergencies, one for showing off.",
                author: "Little Chip, Duluth Paint & Stain Operator"
            },
            {
                quote: "You want gains? Forget protein shakes. Hot dogs are nature's recovery meal.",
                author: "Coach Lyle, Full-Time Performance Coach"
            },
            {
                quote: "Beer tastes better with a hot dog. Hot dogs taste better with beer. I'm a scientist.",
                author: "Dave Swidz, Professional Alcohol Researcher"
            },
            // ...and all the rest of your quotes
        ];

        const HotDogCounter = () => {
            // User state
            const [username, setUsername] = React.useState(null);
            const [showLogin, setShowLogin] = React.useState(false);
            const [loginError, setLoginError] = React.useState('');
            const [loginInput, setLoginInput] = React.useState('');
            
            // App state
            const [count, setCount] = React.useState(0);
            const [streak, setStreak] = React.useState(0);
            const [lastEaten, setLastEaten] = React.useState(null);
            const [globalLogs, setGlobalLogs] = React.useState([]);
            const [isLogOpen, setIsLogOpen] = React.useState(false);
            const [randomQuote, setRandomQuote] = React.useState(null);
            
            // Leaderboard state
            const [leaderboard, setLeaderboard] = React.useState([]);
            const [behindFirstPlace, setBehindFirstPlace] = React.useState(0);

            // Check for existing user on load
            React.useEffect(() => {
                const savedUsername = localStorage.getItem('hotdogUsername');
                if (savedUsername) {
                    setUsername(savedUsername);
                    loadUserData(savedUsername);
                } else {
                    setShowLogin(true);
                }

                // Set random quote
                const randomIndex = Math.floor(Math.random() * HOTDOG_QUOTES.length);
                setRandomQuote(HOTDOG_QUOTES[randomIndex]);

                // Set up Firebase listener for global logs
                const logsRef = database.ref('hotdogLogs');
                logsRef.orderByChild('timestamp').limitToLast(50).on('child_added', (snapshot) => {
                    const log = snapshot.val();
                    log.id = snapshot.key;
                    
                    setGlobalLogs(prev => {
                        // Don't add duplicates
                        if (prev.some(item => item.id === log.id)) {
                            return prev;
                        }

                        // Add new log and sort by timestamp descending
                        const newLogs = [...prev, log].sort((a, b) => b.timestamp - a.timestamp);
                        
                        // Show toast notification for new logs that aren't the user's own
                        if (log.username !== username && log.timestamp > Date.now() - 5000) {
                            showToast(`${log.username} just ate a hot dog! 🌭`);
                        }
                        
                        return newLogs;
                    });
                });
                
                // Set up leaderboard listener
                setupLeaderboardListener();

                return () => {
                    // Clean up Firebase listeners
                    database.ref('hotdogLogs').off();
                    database.ref('users').off();
                };
            }, [username]);
            
            // Set up leaderboard listener
            const setupLeaderboardListener = () => {
                const usersRef = database.ref('users');
                
                // Listen for any changes to user data
                usersRef.on('value', (snapshot) => {
                    const userData = snapshot.val();
                    if (!userData) return;
                    
                    // Convert to array and sort by count
                    const leaders = Object.entries(userData)
                        .map(([key, value]) => ({
                            username: key,
                            ...value
                        }))
                        .sort((a, b) => b.count - a.count)
                        .slice(0, 3); // Take top 3
                    
                    // Check if rankings have changed
                    const prevTop = leaderboard[0]?.username;
                    const prevSecond = leaderboard[1]?.username;
                    const prevThird = leaderboard[2]?.username;
                    
                    const newTop = leaders[0]?.username;
                    const newSecond = leaders[1]?.username;
                    const newThird = leaders[2]?.username;
                    
                    // Notify of rank changes
                    if (prevTop && newTop && prevTop !== newTop) {
                        showToast(`🏆 ${newTop} has taken FIRST PLACE with ${leaders[0].count} hot dogs!`);
                    } else if (prevSecond && newSecond && prevSecond !== newSecond) {
                        showToast(`🥈 ${newSecond} has moved into SECOND PLACE with ${leaders[1].count} hot dogs!`);
                    } else if (prevThird && newThird && prevThird !== newThird) {
                        showToast(`🥉 ${newThird} has claimed THIRD PLACE with ${leaders[2].count} hot dogs!`);
                    }
                    
                    setLeaderboard(leaders);
                    
                    // Calculate how many hot dogs behind first place
                    if (username && leaders.length > 0) {
                        const firstPlaceCount = leaders[0].count || 0;
                        
                        // Find current user's position and count
                        const currentUser = Object.entries(userData)
                            .find(([key]) => key === username);
                            
                        const currentUserCount = currentUser ? currentUser[1].count || 0 : 0;
                        
                        // Calculate the difference (if negative or zero, user is in first place)
                        const behind = Math.max(0, firstPlaceCount - currentUserCount);
                        setBehindFirstPlace(behind);
                    }
                });
            };

            const loadUserData = (user) => {
                database.ref(`users/${user}`).once('value')
                    .then((snapshot) => {
                        const userData = snapshot.val();
                        if (userData) {
                            setCount(userData.count || 0);
                            setStreak(userData.streak || 0);
                            setLastEaten(userData.lastEaten || null);
                        } else {
                            // Initialize new user in Firebase
                            database.ref(`users/${user}`).set({
                                name: user,
                                count: 0,
                                streak: 0,
                                lastEaten: null
                            });
                        }
                    });
            };

            const handleLogin = () => {
                if (!loginInput.trim()) {
                    setLoginError('Please enter a username');
                    return;
                }
                
                // Ensure username is lowercase with no spaces
                const sanitizedUsername = loginInput.trim().toLowerCase().replace(/\s+/g, '');
                
                if (sanitizedUsername !== loginInput) {
                    setLoginInput(sanitizedUsername);
                }
                
                if (sanitizedUsername.length < 3) {
                    setLoginError('Username must be at least 3 characters');
                    return;
                }
                
                // Check if username exists
                database.ref(`users/${sanitizedUsername}`).once('value')
                    .then((snapshot) => {
                        // If exists, use it
                        localStorage.setItem('hotdogUsername', sanitizedUsername);
                        setUsername(sanitizedUsername);
                        setShowLogin(false);
                        setLoginError('');
                        loadUserData(sanitizedUsername);
                    });
            };

            const showToast = (message) => {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = message;
                
                // Add to DOM
                document.getElementById('toast-container').appendChild(toast);
                
                // Add responsive sizing
                const resizeToast = () => {
                    // Adjust font size on smaller screens
                    if (window.innerWidth < 768) {
                        toast.style.fontSize = '0.9rem';
                        toast.style.padding = '0.8rem 1.5rem';
                    } else {
                        toast.style.fontSize = '1.1rem';
                        toast.style.padding = '1rem 2rem';
                    }
                };
                
                // Initial sizing
                resizeToast();
                
                // Listen for resize events
                window.addEventListener('resize', resizeToast);
                
                // Remove after animation finishes
                setTimeout(() => {
                    toast.remove();
                    window.removeEventListener('resize', resizeToast);
                }, 5000);
            };

            const getStreakMessage = (streak) => {
                const messages = [
                    "First hot dog of many!",
                    "Two days of hot dog glory!",
                    "Triple threat!",
                    "Four days strong!",
                    "High five - keep it alive!",
                    "Six days of satisfaction!",
                    "A whole week of wonderful!",
                    "Eight days of excellence!",
                    "Nine days of nobility!",
                    "Perfect ten!",
                    "Unstoppable!"
                ];
                
                return streak === 0 ? "Start your streak!" : 
                       streak <= 10 ? messages[streak - 1] : 
                       messages[messages.length - 1];
            };

            const updateStreak = () => {
                // Use UTC for consistent date calculations
                const now = new Date();
                const todayUTC = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate());
                const yesterdayUTC = todayUTC - 86400000; // 24 hours in milliseconds
                
                let newStreak = streak;
                
                if (!lastEaten) {
                    // First hot dog ever
                    newStreak = 1;
                } else {
                    // Convert stored timestamp to UTC date for comparison
                    const lastEatenDate = new Date(lastEaten);
                    const lastEatenUTC = Date.UTC(
                        lastEatenDate.getUTCFullYear(), 
                        lastEatenDate.getUTCMonth(), 
                        lastEatenDate.getUTCDate()
                    );
                    
                    if (lastEatenUTC < yesterdayUTC) {
                        // Streak broken - more than a day has passed
                        if (lastEatenUTC < todayUTC) {
                            newStreak = 1;
                        }
                    } else if (lastEatenUTC < todayUTC) {
                        // Continuing streak - was yesterday
                        newStreak = streak + 1;
                    }
                    // If already eaten today, keep current streak
                }
                
                setStreak(newStreak);
                
                // Store current time in milliseconds since epoch (UTC)
                const nowTimestamp = Date.now();
                setLastEaten(nowTimestamp);
                
                // Update streak in Firebase with UTC timestamp
                database.ref(`users/${username}`).update({
                    streak: newStreak,
                    lastEaten: nowTimestamp
                });
            };

            const formatTimeAgo = (timestamp) => {
                if (!timestamp) return 'never';
                
                // Calculate time difference from now
                const seconds = Math.floor((Date.now() - timestamp) / 1000);
                
                // Recent times
                if (seconds < 60) return 'moments ago';
                if (seconds < 120) return '1 minute ago';
                if (seconds < 3600) return Math.floor(seconds / 60) + ' minutes ago';
                if (seconds < 7200) return '1 hour ago';
                if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
                
                // Use local date formatting for dates
                const date = new Date(timestamp);
                
                // Check if it's yesterday
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                if (date.getDate() === yesterday.getDate() && 
                    date.getMonth() === yesterday.getMonth() && 
                    date.getFullYear() === yesterday.getFullYear()) {
                    return 'yesterday';
                }
                
                // Within last week
                if (seconds < 604800) {
                    return date.toLocaleDateString('en-US', { weekday: 'long' });
                }
                
                // Default date format for older dates
                return date.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: date.getFullYear() !== new Date().getFullYear() ? 'numeric' : undefined
                });
            };

            const groupLogsByDay = (logs) => {
                const groups = {};
                
                logs.forEach(log => {
                    // Format the date as YYYY-MM-DD to use as group key
                    const date = new Date(log.timestamp);
                    const day = date.toISOString().split('T')[0];
                    
                    // Generate a human-readable label for the day
                    let dayLabel;
                    const today = new Date();
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    const todayDate = today.toISOString().split('T')[0];
                    const yesterdayDate = yesterday.toISOString().split('T')[0];
                    
                    if (day === todayDate) {
                        dayLabel = 'Today';
                    } else if (day === yesterdayDate) {
                        dayLabel = 'Yesterday';
                    } else {
                        dayLabel = date.toLocaleDateString('en-US', {
                            weekday: 'long',
                            month: 'long',
                            day: 'numeric',
                            year: 'numeric'
                        });
                    }
                    
                    if (!groups[day]) {
                        groups[day] = {
                            label: dayLabel,
                            items: []
                        };
                    }
                    
                    groups[day].items.push(log);
                });
                
                // Sort groups by date (most recent first) and sort items within groups
                return Object.values(groups)
                    .sort((a, b) => {
                        // Extract date from first item in each group
                        const dateA = a.items[0]?.timestamp || 0;
                        const dateB = b.items[0]?.timestamp || 0;
                        return dateB - dateA;
                    })
                    .map(group => ({
                        ...group,
                        items: group.items.sort((a, b) => b.timestamp - a.timestamp)
                    }));
            };

            const createHotDog = () => {
                const hotdog = document.createElement('div');
                hotdog.className = 'flying-hotdog';
                hotdog.textContent = '🌭';
                
                const startX = Math.random() * window.innerWidth;
                hotdog.style.left = `${startX}px`;
                hotdog.style.bottom = '0';
                
                const finalX = (Math.random() - 0.5) * window.innerWidth;
                const rotation = (Math.random() - 0.5) * 720;
                
                hotdog.style.setProperty('--final-x', `${finalX}px`);
                hotdog.style.setProperty('--rotation', `${rotation}deg`);
                
                document.body.appendChild(hotdog);
                
                setTimeout(() => {
                    hotdog.remove();
                }, 2600);
            };

            const triggerStrobe = () => {
                const strobe = document.querySelector('.strobe-overlay');
                strobe.classList.add('strobe-active');
                
                setTimeout(() => {
                    strobe.classList.remove('strobe-active');
                }, 500);
            };

            const triggerEffects = () => {
                for (let i = 0; i < 32; i++) {
                    setTimeout(() => createHotDog(), i * 130);
                }
                triggerStrobe();
            };

            const incrementCount = () => {
                const newCount = count + 1;
                setCount(newCount);
                updateStreak();
                
                // Update count in Firebase
                database.ref(`users/${username}`).update({
                    count: newCount,
                    lastEaten: Date.now() // Store exact timestamp
                });
                
                // Add new log entry to global logs
                const newLog = {
                    username: username,
                    timestamp: Date.now() // Store exact timestamp
                };
                
                database.ref('hotdogLogs').push(newLog);
                
                triggerEffects();
            };

            const renderLogin = () => {
                if (!showLogin) return null;
                
                return React.createElement('div', {
                    className: 'login-overlay'
                }, 
                    React.createElement('div', {
                        className: 'login-modal'
                    }, [
                        React.createElement('h2', {
                            className: 'login-title',
                            key: 'title'
                        }, 'Enter Your Hot Dog Name'),
                        React.createElement('input', {
                            type: 'text',
                            className: 'login-input',
                            placeholder: 'e.g. HotDogKing42',
                            value: loginInput,
                            onChange: (e) => setLoginInput(e.target.value),
                            onKeyPress: (e) => e.key === 'Enter' && handleLogin(),
                            key: 'input'
                        }),
                        loginError && React.createElement('div', {
                            className: 'login-message',
                            key: 'error'
                        }, loginError),
                        React.createElement('button', {
                            className: 'login-button',
                            onClick: handleLogin,
                            key: 'button'
                        }, 'Start Eating')
                    ])
                );
            };

            const renderLog = () => {
                const groups = groupLogsByDay(globalLogs);
                
                return React.createElement('div', {
                    className: `log-overlay ${isLogOpen ? 'active' : ''}`
                }, [
                    React.createElement('div', {
                        className: 'log-header',
                        key: 'header'
                    }, [
                        React.createElement('h2', { key: 'title' }, 'Global Hot Dog History'),
                        React.createElement('button', {
                            className: 'log-close',
                            onClick: () => setIsLogOpen(false),
                            key: 'close'
                        }, '×')
                    ]),
                    React.createElement('div', {
                        className: 'log-content',
                        key: 'content'
                    }, 
                        groups.map(group => 
                            React.createElement('div', {
                                className: 'log-group',
                                key: group.label
                            }, [
                                React.createElement('div', {
                                    className: 'log-group-header',
                                    key: 'header'
                                }, group.label),
                                ...group.items.map(item => {
                                    // Check if this user is on the leaderboard
                                    const leaderIndex = leaderboard.findIndex(leader => leader.username === item.username);
                                    const medal = leaderIndex === 0 ? '🥇' : 
                                                 leaderIndex === 1 ? '🥈' : 
                                                 leaderIndex === 2 ? '🥉' : '';
                                    
                                    return React.createElement('div', {
                                        className: 'log-item',
                                        key: item.id
                                    }, [
                                        medal ? React.createElement('span', {
                                            className: 'log-item-emoji',
                                            key: 'medal'
                                        }, medal) : React.createElement('span', {
                                            className: 'log-item-emoji',
                                            key: 'empty'
                                        }, ''),
                                        React.createElement('span', {
                                            className: 'log-item-username',
                                            key: 'username'
                                        }, item.username),
                                        React.createElement('span', {
                                            className: 'log-item-time',
                                            key: 'time'
                                        }, new Date(item.timestamp).toLocaleTimeString())
                                    ]);
                                })
                            ])
                        )
                    )
                ]);
            };

            return React.createElement(React.Fragment, null, [
                renderLogin(),
                React.createElement('div', { 
                    className: 'container',
                    key: 'container'
                }, [
                    username && React.createElement('div', {
                        className: 'user-display',
                        key: 'user'
                    }, `Logged in as: ${username}`),
                    React.createElement('h1', { 
                        className: 'title',
                        key: 'title'
                    }, 'Hot Dog Counter'),
                    React.createElement('div', { 
                        className: 'count',
                        key: 'count'
                    }, count),
                    React.createElement('p', { 
                        className: 'subtitle',
                        key: 'subtitle'
                    }, 'Hot Dogs Devoured'),
                    randomQuote && React.createElement('div', {
                        className: 'quote-container',
                        key: 'quote'
                    }, [
                        React.createElement('div', {
                            className: 'quote-text',
                            key: 'quote-text'
                        }, `"${randomQuote.quote}"`),
                        React.createElement('div', {
                            className: 'quote-attribution',
                            key: 'quote-author'
                        }, `— ${randomQuote.author}`)
                    ]),
                    React.createElement('div', {
                        className: 'button-container',
                        key: 'button-container'
                    }, [
                        React.createElement('button', {
                            onClick: incrementCount,
                            className: 'hotdog-button',
                            key: 'button',
                            disabled: !username
                        }, 'I Ate a Hot Dog!')
                    ]),
                    React.createElement('div', {
                        className: 'streak-container',
                        key: 'streak'
                    }, [
                        React.createElement('div', {
                            className: 'streak-count',
                            key: 'streak-count'
                        }, `${streak} day streak`),
                        React.createElement('div', {
                            className: 'streak-message',
                            key: 'streak-message'
                        }, getStreakMessage(streak)),
                        behindFirstPlace > 0 && React.createElement('div', {
                            className: 'behind-first',
                            key: 'behind-first'
                        }, `${behindFirstPlace} hot dogs behind first place`),
                        behindFirstPlace === 0 && leaderboard.length > 0 && leaderboard[0]?.username === username && React.createElement('div', {
                            className: 'behind-first',
                            key: 'first-place'
                        }, `🏆 You're in first place!`)
                    ]),
                    React.createElement('div', {
                        className: 'leaderboard',
                        key: 'leaderboard'
                    }, [
                        React.createElement('div', {
                            className: 'leaderboard-title',
                            key: 'leaderboard-title'
                        }, '🌭 Grease Missile Captains 🌭'),
                        leaderboard.map((leader, index) => {
                            const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : '🥉';
                            return React.createElement('div', {
                                className: 'leader-item',
                                key: leader.username
                            }, [
                                React.createElement('div', {
                                    className: 'leader-medal',
                                    key: 'medal'
                                }, medal),
                                React.createElement('div', {
                                    className: 'leader-name',
                                    key: 'name'
                                }, leader.username),
                                React.createElement('div', {
                                    className: 'leader-count',
                                    key: 'count'
                                }, `${leader.count || 0} 🌭`),
                                React.createElement('div', {
                                    className: 'leader-time',
                                    key: 'time'
                                }, leader.lastEaten ? formatTimeAgo(leader.lastEaten) : 'never')
                            ]);
                        })
                    ]),
                    React.createElement('div', {
                        className: 'branding',
                        key: 'branding'
                    }, [
                        'presented by ',
                        React.createElement('span', {key: 'brand'}, 'Scrambled Legs'),
                        React.createElement('span', {
                            className: 'trademark',
                            key: 'trademark'
                        }, '™')
                    ]),
                    React.createElement('button', {
                        className: 'log-button',
                        onClick: () => setIsLogOpen(true),
                        key: 'log-button'
                    }, '🌭 Hot Dog History')
                ]),
                renderLog()
            ]);
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(HotDogCounter));
    </script>
</body>
</html>